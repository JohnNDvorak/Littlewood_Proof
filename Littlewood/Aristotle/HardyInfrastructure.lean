/-
This file was generated by Aristotle.

Lean version: leanprover/lean4:v4.24.0
Mathlib version: f897ebcf72cd16f89ab4577d0c826cd14afaafc7
This project request had uuid: 8f433df8-5017-4a00-bcba-488850d7dbb7

To cite Aristotle, tag @Aristotle-Harmonic on GitHub PRs/issues, and add as co-author to commits:
Co-authored-by: Aristotle (Harmonic) <aristotle-harmonic@harmonic.fun>

Aristotle's budget for this request has been reached.
If there is partial progress, it will appear in this file.
If you would like to continue working off of this partial progress,
please submit the same prompt, and add this .lean file in "Optional: Attach a Lean file as context" field.
-/

import Mathlib

set_option linter.mathlibStandardSet false

open scoped BigOperators
open scoped Real
open scoped Nat
open scoped Classical
open scoped Pointwise

set_option maxHeartbeats 0
set_option maxRecDepth 4000
set_option synthInstance.maxHeartbeats 20000
set_option synthInstance.maxSize 128

set_option relaxedAutoImplicit false
set_option autoImplicit false

noncomputable section

namespace HardyInfrastructure

/-
Defining Hardy's theta function and Hardy's Z function. Hardy's theta is defined using the argument of the Gamma function. Hardy's Z function is defined as the real part of the product of the exponential of i*theta and the Riemann zeta function on the critical line.
-/
noncomputable def hardyTheta (t : ℝ) : ℝ :=
  (Complex.Gamma (1 / 4 + (t / 2) * Complex.I)).arg - (t / 2) * Real.log Real.pi

noncomputable def hardyZ (t : ℝ) : ℝ :=
  (Complex.exp (Complex.I * hardyTheta t) * riemannZeta (1 / 2 + Complex.I * t)).re

/-
Proving that Hardy's Z function is real-valued. This is true by definition since it is defined as the real part of a complex number.
-/
theorem hardyZ_is_real (t : ℝ) : (hardyZ t : ℂ).im = 0 := by
  rw [hardyZ]
  exact Complex.ofReal_im _

/-
Lemma: Hardy's Z function is zero if and only if the Riemann zeta function is zero on the critical line.
This relies on the assumption `h_Z_real` that `exp(i*theta) * zeta` is real-valued.
Since `exp` is never zero, the product is zero iff `zeta` is zero.
-/
theorem hardyZ_zero_iff_zeta_zero
    (h_Z_real : ∀ t, (Complex.exp (Complex.I * hardyTheta t) * riemannZeta (1/2 + Complex.I * t)).im = 0)
    (t : ℝ) :
    hardyZ t = 0 ↔ riemannZeta (1/2 + Complex.I * t) = 0 := by
      -- By definition of hardyZ, we know that hardyZ t = 0 if and only if the real part of the product is zero.
      have h_real_part : hardyZ t = 0 ↔ (Complex.exp (Complex.I * (hardyTheta t)) * riemannZeta (1 / 2 + Complex.I * t)).re = 0 := by
        unfold hardyZ; aesop;
      simp_all +decide [ Complex.ext_iff ];
      constructor <;> intro h <;> simp_all +decide [ Complex.exp_re, Complex.exp_im ];
      constructor <;> nlinarith [ h_Z_real t, Real.sin_sq_add_cos_sq ( hardyTheta t ), Real.sin_le_one ( hardyTheta t ), Real.cos_le_one ( hardyTheta t ) ]

/-
Defining the hypotheses required for Hardy's theorem.
1. `completed_real`: The completed Riemann Zeta function is real on the critical line.
2. `Z_continuous`: Hardy's Z function is continuous.
3. `Z_integral_bound`: The integral of Z from 0 to T is bounded by C * T^(1/2 + ε). This corresponds to the fact that the integral of Z is small compared to the integral of Z^2.
4. `Z_sq_integral_lower_bound`: The integral of Z^2 from 0 to T grows at least as c * T * log T. This is the mean square lower bound.
-/
structure HardyHypotheses where
  /-- The completed Riemann Zeta function is real on the critical line. -/
  completed_real : ∀ t : ℝ, (completedRiemannZeta (1 / 2 + Complex.I * t)).im = 0
  /-- Hardy's Z function is continuous. -/
  Z_continuous : Continuous hardyZ
  /-- Mean square upper bound for the integral of Z. -/
  Z_integral_bound : ∀ T : ℝ, T > 0 → ∃ C ε : ℝ, C > 0 ∧ ε > 0 ∧
    ‖∫ t in Set.Ioc 0 T, hardyZ t‖ ≤ C * T ^ (1 / 2 + ε)
  /-- Mean square lower bound for the integral of Z^2. -/
  Z_sq_integral_lower_bound : ∃ c T₀ : ℝ, c > 0 ∧ T₀ > 0 ∧
    ∀ T ≥ T₀, ∫ t in Set.Ioc 0 T, (hardyZ t) ^ 2 ≥ c * T * Real.log T

/-
Redefining HardyHypotheses with the correct quantifier structure for the integral bound. The previous definition was too weak.
`Z_integral_bound`: For every `ε > 0`, there exists `C` such that the integral is bounded by `C * T^(1/2 + ε)` for large `T`.
-/
structure HardyHypotheses' where
  /-- The completed Riemann Zeta function is real on the critical line. -/
  completed_real : ∀ t : ℝ, (completedRiemannZeta (1 / 2 + Complex.I * t)).im = 0
  /-- Hardy's Z function is continuous. -/
  Z_continuous : Continuous hardyZ
  /-- Mean square upper bound for the integral of Z. -/
  Z_integral_bound : ∀ ε > 0, ∃ C T₀ : ℝ, ∀ T ≥ T₀,
    ‖∫ t in Set.Ioc 0 T, hardyZ t‖ ≤ C * T ^ (1 / 2 + ε)
  /-- Mean square lower bound for the integral of Z^2. -/
  Z_sq_integral_lower_bound : ∃ c T₀ : ℝ, c > 0 ∧ T₀ > 0 ∧
    ∀ T ≥ T₀, ∫ t in Set.Ioc 0 T, (hardyZ t) ^ 2 ≥ c * T * Real.log T

end HardyInfrastructure