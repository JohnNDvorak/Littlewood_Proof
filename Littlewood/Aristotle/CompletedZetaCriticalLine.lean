/-
This file was generated by Aristotle.

Lean version: leanprover/lean4:v4.24.0
Mathlib version: f897ebcf72cd16f89ab4577d0c826cd14afaafc7
This project request had uuid: 7881a8f9-9efa-46ec-a0d4-0787dedab372

To cite Aristotle, tag @Aristotle-Harmonic on GitHub PRs/issues, and add as co-author to commits:
Co-authored-by: Aristotle (Harmonic) <aristotle-harmonic@harmonic.fun>
-/

/-
This module proves that the completed Riemann zeta function is real on the critical line.
It defines helper lemmas for the conjugation of the Mellin transform of real-valued functions
and the conjugation symmetry of the completed Riemann zeta function.
The main result is `completedRiemannZeta_critical_line_real`.
-/

import Mathlib
import Littlewood.Aristotle.HardyZConjugation

set_option linter.mathlibStandardSet false

open scoped BigOperators
open scoped Real
open scoped Nat
open scoped Classical
open scoped Pointwise

set_option maxHeartbeats 0
set_option maxRecDepth 4000
set_option synthInstance.maxHeartbeats 20000
set_option synthInstance.maxSize 128

set_option relaxedAutoImplicit false
set_option autoImplicit false

noncomputable section

namespace CompletedZetaCriticalLine

#print completedRiemannZeta

#check (star : ℂ → ℂ)

#print HurwitzZeta.completedHurwitzZetaEven₀

#print HurwitzZeta.hurwitzEvenFEPair

#print WeakFEPair.Λ₀

/-
If a function $f$ is real-valued, then its Mellin transform satisfies $\mathcal{M}f(\bar{s}) = \overline{\mathcal{M}f(s)}$.
-/
theorem mellin_conj_of_real_valued {f : ℝ → ℂ} (hf : ∀ x, star (f x) = f x) (s : ℂ) :
    mellin f (star s) = star (mellin f s) := by
      unfold mellin;
      simp +zetaDelta at *;
      rw [ ← integral_conj ];
      refine' MeasureTheory.setIntegral_congr_fun measurableSet_Ioi fun x hx => _;
      simp +decide [ Complex.cpow_def, Complex.exp_re, Complex.exp_im, Complex.log_re, Complex.log_im, Complex.sub_re, Complex.sub_im, Complex.one_re, Complex.one_im, hf ];
      simp +decide [ hx.out.ne', Complex.ext_iff, Complex.exp_re, Complex.exp_im, Complex.log_re, Complex.log_im, hf ];
      norm_num [ Complex.arg_ofReal_of_nonneg hx.out.le ]

/-
The completed Riemann zeta function satisfies the conjugation symmetry $\xi(\bar{s}) = \overline{\xi(s)}$.
-/
theorem completedRiemannZeta_conj (s : Complex) : completedRiemannZeta (star s) = star (completedRiemannZeta s) :=
  HardyZConjugation.completedRiemannZeta_conj s

/-
The completed Riemann zeta function is real on the critical line.
-/
theorem completedRiemannZeta_critical_line_real (t : Real) :
    (completedRiemannZeta (1/2 + Complex.I * t)).im = 0 := by
      -- By `completedRiemannZeta_conj`, we have `completedRiemannZeta (star s) = star (completedRiemannZeta s)`.
      have h_conj : completedRiemannZeta (star (1 / 2 + Complex.I * t)) = star (completedRiemannZeta (1 / 2 + Complex.I * t)) := by
        exact completedRiemannZeta_conj _;
      -- By `completedRiemannZeta_one_sub`, we have `completedRiemannZeta (1 - s) = completedRiemannZeta s`.
      have h_one_sub : completedRiemannZeta (1 - (1 / 2 + Complex.I * t)) = completedRiemannZeta (1 / 2 + Complex.I * t) := by
        rw [ completedRiemannZeta_one_sub ];
      norm_num [ Complex.ext_iff ] at *;
      ring_nf at *; linarith
end CompletedZetaCriticalLine
