/-
This file was generated by Aristotle.

Lean version: leanprover/lean4:v4.24.0
Mathlib version: f897ebcf72cd16f89ab4577d0c826cd14afaafc7
This project request had uuid: 1737b10e-9e85-4767-b66f-fe1f470f4c63

Co-authored-by: Aristotle (Harmonic) <aristotle-harmonic@harmonic.fun>

Standalone file: Perron formula definitions (budget reached before proofs).
NOT imported by any bridge — definitions only, no theorems.

Contains (0 sorries, 0 theorems):
- verticalIntegral: contour integral along vertical segment (Set.Ioc variant)
- perronIntegral: truncated Perron integral (1/2πi) ∫ y^s/s ds
- DirichletSeries: structure with coefficients and abscissa
- DirichletSeries.sum, DirichletSeries.partialSum
- perronError: explicit error bound for Perron's formula
-/

import Mathlib

set_option linter.mathlibStandardSet false

open scoped BigOperators
open scoped Real
open scoped Nat
open scoped Classical
open scoped Pointwise

set_option maxHeartbeats 1600000
set_option maxRecDepth 4000
set_option synthInstance.maxHeartbeats 20000
set_option synthInstance.maxSize 128

set_option relaxedAutoImplicit false
set_option autoImplicit false

noncomputable section

namespace Aristotle.PerronFormulaV3

/-
Definition of verticalIntegral and perronIntegral.
verticalIntegral computes the contour integral of f along the vertical line segment from c + i*a to c + i*b.
perronIntegral is the specific integral used in Perron's formula.
-/
noncomputable def verticalIntegral (f : ℂ → ℂ) (c a b : ℝ) : ℂ :=
  ∫ t in Set.Ioc a b, f (c + t * Complex.I) * Complex.I

/-- The truncated Perron integral -/
noncomputable def perronIntegral (y : ℝ) (c T : ℝ) : ℂ :=
  (1 / (2 * Real.pi * Complex.I)) * verticalIntegral (fun s => y^s / s) c (-T) T

/-
Definition of DirichletSeries, its sum, and partial sum of coefficients.
-/
/-- A Dirichlet series F(s) = Σ aₙ/nˢ with abscissa of absolute convergence σ_a -/
structure DirichletSeries where
  coeff : ℕ → ℂ
  absConv : ℝ  -- abscissa of absolute convergence

/-- The sum function for a Dirichlet series -/
noncomputable def DirichletSeries.sum (F : DirichletSeries) (s : ℂ) : ℂ :=
  ∑' n, F.coeff n / (n : ℂ)^s

/-- Partial sum of coefficients -/
noncomputable def DirichletSeries.partialSum (F : DirichletSeries) (x : ℝ) : ℂ :=
  ∑ n ∈ Finset.range (Nat.floor x + 1), F.coeff n

/-
Definition of the error bound for Perron's formula applied to a Dirichlet series.
-/
/-- Explicit error bound for Perron's formula applied to a Dirichlet series -/
noncomputable def perronError (F : DirichletSeries) (x c T : ℝ) : ℝ :=
  ∑' n, ‖F.coeff n‖ * (
    if (n : ℝ) < x then
      (x / n)^c / (T * |Real.log (x / n)|) + (x / n)^c / (T * c)
    else
      (x / n)^c / (T * |Real.log (x / n)|)
  )

end Aristotle.PerronFormulaV3